# «API Сервис заказа товаров для розничных сетей»

---

## Описание

Приложение предназначено для автоматизации закупок в розничной сети. Пользователи сервиса — покупатель (менеджер торговой сети, который закупает товары для продажи в магазине) и поставщик товаров.

**Покупатель:**

- Менеджер закупок через API делает ежедневные закупки по каталогу, в котором
  представлены товары от нескольких поставщиков.
- В одном заказе можно указать товары от разных поставщиков.
- Пользователь может авторизоваться, регистрироваться и восстанавливать пароль через API.
    
**Поставщик:**

- Через API информирует сервис об обновлении прайса.
- Может включать и отключать прием заказов.
- Может получать список оформленных заказов (с товарами из его прайса).

---
### Инструкция по запуску проекта в `docker`:
* Создать файл `.env` в корне проекта и заполнить
  - SECRET_KEY=...

  - POSTGRES_ENGINE=django.db.backends.postgresql
  - POSTGRES_USER=...
  - POSTGRES_PASSWORD=...
  - POSTGRES_DB=...
  - POSTGRES_HOST=db
  - POSTGRES_PORT=5432

  - EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
  - EMAIL_HOST=smtp.yandex.ru (как пример, зависит от почты)
  - EMAIL_PORT=587 (как пример, зависит от почты)
  - EMAIL_HOST_USER=example@yandex.ru (как пример)
  - EMAIL_HOST_PASSWORD=... (пароль от почтового адреса)
  - EMAIL_USE_TLS=True (как пример, зависит от от почты)
  - EMAIL_USE_SSL=False (как пример, зависит от от почты)

  - CELERY_BROKER_URL=redis://redis:6379/0
  - CELERY_RESULT_BACKEND=redis://redis:6379/1

  - SOCIAL_AUTH_YANDEX_KEY=<ClientID Яндекс-приложения> 
  - SOCIAL_AUTH_YANDEX_SECRET=<Client secret Яндекс-приложения>

* Ввести команду `docker-compose up --build -d` (в корне проекта)
* Если не хотите, чтобы база данных заполнялась тренировочными данными
с созданным суперпользователем (email: 'su@su.su', пароль: 'su'), 
удалите предварительно из docker-compose соответствующую команду.
---

### Детали

- Регистрация. При регистрации пользователь-поставщик должен передать `type='supplier'`
(ибо по умолчанию - `buyer` (покупатель)). Хотя это можно сделать и позже, внеся изменения в профиле.
- После нужно залогиниться, а потом подтвердить свой аккаунт разовым токеном, пришедшим по почте (да, не так все просто).
- В ответ на подтверждение аккаунта придет токен авторизации, который нужно будет указывать в дальнейших запросах.
- Возможна авторизация через Yandex (пользователь должен получить токен от Яндекса). 
  - Предварительно необходимо:
    1. Создать Яндекс-приложение;
    2. Создать приложение в админ-панели (DJANGO OAUTH TOOLKIT / Applications).
- Чтобы пользователь мог покупать (`'buyer'`), он должен создать одного или, если очень захочет, нескольких покупателей.
- Чтобы пользователь мог размещать товары для продажи (`'supplier'`), он должен создать одного или нескольких поставщиков.

---

### Примеры запросов
- [requests.txt](requests.txt)




